Module 07 — Malware Analysis (CEH v13)
Objective

Provide learners with practical skills to identify, analyze, and respond to malware. The module covers static and dynamic analysis techniques, sandboxing, behavior analysis, reversing basics, and safe handling and documentation of malware samples in a controlled lab environment.

Description

Malware Analysis teaches how to safely study malicious code to understand its capabilities, indicators of compromise (IOCs), propagation methods, persistence mechanisms, and payload behavior. This module balances theory (malware types, attack vectors, lifecycle) with hands-on labs (static inspection, dynamic execution in a sandbox, memory and network analysis) and emphasises safety, containment, and legal/ethical controls.

Key Learning Outcomes

After completing this module you will be able to:

Classify malware types (viruses, worms, trojans, ransomware, rootkits, backdoors, droppers).

Use safe lab practices to handle and analyze malware samples.

Perform static analysis to extract strings, file metadata, embedded resources, and suspicious constructs without executing the sample.

Perform dynamic analysis to observe runtime behavior, file/system changes, network activity, and persistence.

Extract IOCs (file hashes, mutexes, domains, IPs, registry keys) for detection and hunting.

Use memory forensics to capture and analyze volatile evidence.

Apply basic reverse-engineering techniques to understand program flow and intent (introductory disassembly/decompilation).

Produce clear, actionable malware analysis reports for incident response and remediation teams.

Techniques Covered

Sample triage and classification (PE, ELF, scripts, Office macros).

Static analysis: strings, exiftool, peframe, lief, file headers, entropy checks.

Dynamic analysis: sandboxing (Cuckoo), process monitoring, API tracing.

Behavioral analysis: file system, registry, process creation, persistence, scheduled tasks.

Network analysis: capturing DNS/HTTP/HTTPS/C2 traffic, identifying beacons and exfil patterns.

Memory analysis: acquire memory dumps and analyze with Volatility or Rekall.

Reverse engineering basics: IDA/ghidra workflows, function identification, decompilation for simple binaries.

Extracting and validating IOCs and mapping to ATT&CK techniques.

Common Tools
Purpose	Tools / Examples
Static analysis	strings, exiftool, peframe, PEiD, rabin2
Dynamic / sandbox	Cuckoo Sandbox, Any.Run, isolated VMs(snapshots)
Process & syscall tracing	Procmon (Windows), strace, sysdig
Network capture & analysis	Wireshark, tcpdump, Zeek
Memory forensics	Volatility, Rekall
Reverse engineering	Ghidra, IDA Free, radare2
Automated triage	YARA (rules), VirusTotal, Hybrid-Analysis
Scripting & helpers	python, pefile, capstone, unicorn (emulation)
Example Lab Tasks (step-by-step)

Triage

Validate sample hash, determine file type, check VT/Hybrid results, and assess risk.

Static inspection (no execution)

Run strings, check PE headers, detect packers, inspect embedded URLs/domains.

Safe dynamic run

Execute sample inside an isolated VM/sandbox (snapshot before run). Monitor process, file, registry, and network activity; capture pcap.

Behavioral analysis

Document new files, created services, registry modifications, scheduled tasks, child processes, and network connections.

Memory capture & analysis

Dump memory of infected VM and analyze for injected code, deobfuscated strings, and credentials.

Reverse-engineer small function

Open binary in Ghidra/IDA, locate suspicious function (string decryption, C2 routine), try to recover plaintext domains.

IOC extraction & enrichment

Collect hashes, domains, IPs, filenames, mutexes; look up passive DNS and reputation; create YARA signatures.

Report

Produce a malware analysis report: summary, technical findings, IOCs, TTP mapping (MITRE ATT&CK), recommended containment/remediation.

Deliverables

malware-analysis-report.pdf / .md — executive summary, technical findings, timeline, and remediation steps.

IOCs.csv — file hashes, domains, IPs, file paths, registry keys, YARA rules.

pcap/ — captured network traffic (anonymized if necessary).

memory-dumps/ — raw memory captures (secure storage).

artifacts/ — screenshots, sandbox logs, extracted files, and commands.

rules/ — YARA rules or Snort/Zeek signatures for detection.

Countermeasures & Remediation

Isolate infected hosts immediately; block identified C2 domains/IPs at edge and DNS.

Remove persistence artifacts (services, scheduled tasks, autoruns) and rebuild compromised hosts when necessary.

Apply patches and harden configurations; enforce application allow-listing.

Deploy/augment endpoint detection rules using extracted IOCs and behavioral indicators.

Rotate credentials and secrets if credential theft is suspected.

Use threat intelligence to correlate with other incidents and upstream sources.

Safety, Legal & Operational Notes

Always analyze malware in air-gapped or isolated virtual environments with no routing to production networks.

Obtain required approvals and follow organisational IR playbooks.

Treat all samples and analysis artifacts as sensitive — store and transmit securely.

Do not run samples on personal or production machines.

For complex reverse engineering that may cross legal boundaries, consult legal/management before proceeding
